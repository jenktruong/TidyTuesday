---
title: 'Tidy Tuesday 2022 W5: Dog Breeds!'
author: "Jennifer Truong"
date: "2/2/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE)

#Load packages
library(tidyverse)
library(tidytuesdayR)
library(ggradar) # for radar plot
library(scales) 
library(janitor) # For easier data cleaning
library(showtext) # for additional fonts

## Loading Google fonts (https://fonts.google.com/)
#font_add_google("Josefin Sans", "josefin")
#font_add_google("Dosis", "dosis")

# Open graphics device for google fonts
#op = showtext_opts(dpi = 300)
#png("dpi_300.png", 800, 800, res = 300)
#par(family = "josefin")
#par(family = "dosis")
```

```{r Load data}
# Had to read in manually this week

breed_traits <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-02-01/breed_traits.csv')
trait_description <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-02-01/trait_description.csv')
breed_rank_all <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-02-01/breed_rank.csv')
```

# Data Exploration

```{r Create subset}
breedtop10 <- breed_rank_all %>%
  clean_names() %>% # Change attribute names to lower case for easier coding
  select(breed, x2020_rank, links, image) %>% # Select 2020 column and other non-rank columns
  head(10) # Keep only top 10 rows

```

The top 10 are:
 [1] "Retrievers (Labrador)"         "French Bulldogs"              
 [3] "German Shepherd Dogs"          "Retrievers (Golden)"          
 [5] "Bulldogs"                      "Poodles"                      
 [7] "Beagles"                       "Rottweilers"                  
 [9] "Pointers (German Shorthaired)" "Dachshunds" 


```{r Subset trait table}
# Change attribute names in breed_traits to lower case as well
breed_traits_clean <- breed_traits %>%
  clean_names() %>%
  head(10) %>% # Look at top 10 rows
  select(breed, openness_to_strangers:mental_stimulation_needs) %>% # Remove the two non-numeric columns besides breed
  rename("Open to Strangers" = "openness_to_strangers",
         "Playful" = "playfulness_level",
         "Protective" = "watchdog_protective_nature",
         "Adaptive" = "adaptability_level",
         "Trainable" = "trainability_level",
         "Energetic" = "energy_level",
         "Bark" = "barking_level",
         "Mental Needs" = "mental_stimulation_needs") # Rename for easier labeling

# Something is causing "Retrievers (Labrador)", "French Bulldogs", "German Shepherd Dogs", "Retrievers (Golden)", and "Pointers (German Shorthaired)" to not join properly

# I commented out the code for joining tables, unless a solution comes by somehow

# Join tables
#breedtop10_join <- left_join(breedtop10, 
                             #breed_traits_clean, 
                             #by = "breed")

```

Okay let's create our radar plots for the top 10 breeds now!

```{r}
# Rescale data first
breed_traits_clean %>%
  mutate_at(vars(-breed), rescale) %>%
  rename("group" = "breed")
 
# Create plot
breed_radar <- breed_traits_clean %>%
  ggradar(
    grid.min = 1, grid.mid = 3, grid.max = 5,
    values.radar = c("1", "3","5"),
    grid.label.size = 4,
    axis.label.size = 4,
    group.line.width = 1,
    group.point.size = 1.5,
    group.colours = "navyblue"
  ) +
  facet_wrap(vars(group), ncol = 5) + # Facet wrap by breed
  labs(title = "Meet America's Most Popular Doggos",
       subtitle = "Personality traits of the top 10 dogs based on 2020 rankings.",
       caption = "Data: American Kennel Club\n Viz: @jenjentro\n #TidyTuesday 2022 W5") +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold",
                              size = 20,
                              hjust = .5),
    plot.subtitle = element_text(face = "italic",
                                 size = 14, 
                                 hjust = .5),
    plot.caption = element_text(size = 12),
    strip.background = element_rect(fill = "navyblue", color = NULL),
    strip.text = element_text(color = "white"),
    legend.position="none"
  )

# View plot
breed_radar
```


